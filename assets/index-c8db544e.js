var j=Object.defineProperty;var q=(o,s,t)=>s in o?j(o,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[s]=t;var k=(o,s,t)=>(q(o,typeof s!="symbol"?s+"":s,t),t);import{i as A,a as Q,r as z,_ as F,b as W}from"./index-649d11d8.js";import{r as w,M as V,f as S,g as T,o as C,h as L,t as v,j as e,N as X,O as I,P as E,y as l,x as r,Q as h,k as y,F as N,R as H,S as $,U as G,V as U,W as B,X as J,n as Y,s as Z}from"./vendor-eac2f17d.js";var _=(o=>(o[o.LOGIN=0]="LOGIN",o[o.REGISTER=1]="REGISTER",o[o.RESET_PASSWORD=2]="RESET_PASSWORD",o[o.MOBILE=3]="MOBILE",o[o.QR_CODE=4]="QR_CODE",o))(_||{});const D=w(0);function P(){function o(n){D.value=n}const s=V(()=>D.value);function t(){o(0)}return{setLoginState:o,getLoginState:s,handleBackLogin:t}}const ee={class:"mb-15px text-center enter-x-350"},M=S({__name:"Title",setup(o){const{getLoginState:s}=P(),{t}=T(),n=V(()=>({[_.LOGIN]:t("login.submitText"),[_.REGISTER]:t("login.registerText"),[_.MOBILE]:t("login.mobileLogin"),[_.RESET_PASSWORD]:t("login.forgetFormTitle"),[_.QR_CODE]:t("login.qrCodeLogin")})[e(s)]);return(a,i)=>(C(),L("h2",ee,v(e(n)),1))}}),{t:K}=A.global,te={name:[{required:!0,message:K("rule.loginName"),trigger:"blur"}],password:[{required:!0,message:K("rule.loginPassword"),trigger:"blur"}]},oe="DEV",le={DEV:"/admin-api",MOCK:"/admin-mock"},se="http://101.43.40.212:8090"+le[oe],ne={login:`${se}/login`},re="",ae={baseURL:re,timeout:6e4,withCredentials:!0};class ie{constructor(s){k(this,"service");this.service=X.create(s),this.service.interceptors.request.use(t=>(t.headers={token:localStorage.getItem("token")||""},{...t}),t=>{Promise.reject(t)}),this.service.interceptors.response.use(t=>{const n=Q(),{data:a,config:i}=t;return a.code===600?(n.clearToken(),console.log(i),Promise.reject(a)):a.code&&a.code!==200?Promise.reject(a):a},t=>{const{response:n}=t;n&&this.handleCode(n.status)})}handleCode(s){}get(s,t){return this.service.get(s,{params:t})}post(s,t){return this.service.post(s,t)}put(s,t){return this.service.put(s,t)}delete(s,t){return this.service.delete(s,{params:t})}}const ce=new ie(ae),ue=async o=>await ce.post(ne.login,o),de=S({__name:"LoginForm",setup(o){const s=w(te),{t}=T(),{getLoginState:n,setLoginState:a}=P(),i=V(()=>e(n)===_.LOGIN),p=w({name:"",password:""}),R=w(),g=async()=>{if(!await R.value.validate(b=>b))return;const{name:u,password:c}=p.value,{success:m,message:d}=await ue({name:u,password:c});if(!m)return H.warning(d||"");z.push({path:"/home/work"})};return(O,u)=>{const c=$,m=G,d=U,b=B;return C(),L(N,null,[I(l(M,null,null,512),[[E,e(i)]]),I(l(b,{ref_key:"formRef",ref:R,rules:e(s),model:e(p)},{default:r(()=>[l(m,{prop:"name"},{default:r(()=>[l(c,{class:"enter-x-350",modelValue:e(p).name,"onUpdate:modelValue":u[0]||(u[0]=f=>e(p).name=f),onKeypress:h(g,["enter"]),placeholder:e(t)("login.loginNamePlacehodel"),clearable:""},null,8,["modelValue","onKeypress","placeholder"])]),_:1}),l(m,{prop:"password"},{default:r(()=>[l(c,{class:"enter-x-500",modelValue:e(p).password,"onUpdate:modelValue":u[1]||(u[1]=f=>e(p).password=f),placeholder:e(t)("login.loginPasswordPlacehodel"),onKeypress:h(g,["enter"]),clearable:"","animate-delay-200":""},null,8,["modelValue","placeholder","onKeypress"])]),_:1}),l(m,null,{default:r(()=>[l(d,{class:"btn enter-x-700 w-full",size:"large",type:"primary",onClick:g},{default:r(()=>[y(v(e(t)("login.submitText")),1)]),_:1})]),_:1}),l(m,null,{default:r(()=>[l(d,{class:"enter-x-800",type:"default",onClick:u[2]||(u[2]=f=>e(a)(e(_).MOBILE))},{default:r(()=>[y(v(e(t)("login.mobileLogin")),1)]),_:1}),l(d,{class:"enter-x-800",type:"default",onClick:u[3]||(u[3]=f=>e(a)(e(_).QR_CODE))},{default:r(()=>[y(v(e(t)("login.qrCodeLogin")),1)]),_:1}),l(d,{class:"enter-x-800",type:"default",onClick:u[4]||(u[4]=f=>e(a)(e(_).REGISTER))},{default:r(()=>[y(v(e(t)("login.registerText")),1)]),_:1})]),_:1})]),_:1},8,["rules","model"]),[[E,e(i)]])],64)}}});const _e=()=>{const o=w(0),{pause:s,resume:t}=J(()=>{o.value===0?s():o.value--},1e3,{immediate:!1});return{counter:o,starte:a=>{o.value=a,t()}}},pe=S({__name:"RegisterForm",setup(o){const{getLoginState:s,setLoginState:t}=P(),{t:n}=T(),a=V(()=>e(s)===_.REGISTER),i=w({name:"",password:"",mobile:"",validCode:"",code:""}),p=()=>{console.log(i)},{starte:R,counter:g}=_e(),O=()=>{R(60)};return(u,c)=>{const m=$,d=G,b=U,f=B;return C(),L(N,null,[I(l(M,null,null,512),[[E,e(a)]]),I(l(f,{model:e(i)},{default:r(()=>[l(d,null,{default:r(()=>[l(m,{class:"enter-x-150",modelValue:e(i).name,"onUpdate:modelValue":c[0]||(c[0]=x=>e(i).name=x),onKeypress:h(p,["enter"]),placeholder:e(n)("login.loginNamePlacehodel"),clearable:""},null,8,["modelValue","onKeypress","placeholder"])]),_:1}),l(d,{class:"nowrap"},{default:r(()=>[l(m,{class:"enter-x-300",modelValue:e(i).code,"onUpdate:modelValue":c[1]||(c[1]=x=>e(i).code=x),placeholder:e(n)("login.smsPlacehodel"),onKeypress:h(p,["enter"]),clearable:""},null,8,["modelValue","placeholder","onKeypress"]),l(b,{class:Y(["ml-2 enter-x-300",{disabled:!!e(g)}]),disabled:!!e(g),onClick:O},{default:r(()=>[y(v(e(g)?`${e(g)}秒后重新获取`:e(n)("login.sms")),1)]),_:1},8,["class","disabled"])]),_:1}),l(d,null,{default:r(()=>[l(m,{class:"enter-x-300",modelValue:e(i).mobile,"onUpdate:modelValue":c[2]||(c[2]=x=>e(i).mobile=x),placeholder:e(n)("login.mobilePlacehodel"),onKeypress:h(p,["enter"]),clearable:""},null,8,["modelValue","placeholder","onKeypress"])]),_:1}),l(d,null,{default:r(()=>[l(m,{class:"enter-x-500",modelValue:e(i).password,"onUpdate:modelValue":c[3]||(c[3]=x=>e(i).password=x),placeholder:e(n)("login.loginPasswordPlacehodel"),onKeypress:h(p,["enter"]),clearable:""},null,8,["modelValue","placeholder","onKeypress"])]),_:1}),l(d,null,{default:r(()=>[l(b,{class:"btn enter-x-500 w-full",size:"large",type:"primary"},{default:r(()=>[y(v(e(n)("login.registerText")),1)]),_:1})]),_:1}),l(d,null,{default:r(()=>[l(b,{class:"btn enter-x-500 w-full",size:"large",type:"default",onClick:c[4]||(c[4]=x=>e(t)(e(_).LOGIN))},{default:r(()=>[y(v(e(n)("login.back")),1)]),_:1})]),_:1})]),_:1},8,["model"]),[[E,e(a)]])],64)}}});const me=F(pe,[["__scopeId","data-v-dbef5255"]]),ge={class:"login w-full relative flex flex-items-center flex-justify-center bg-#293146"},fe={class:"login_form enter-x-200"},xe=S({__name:"index",setup(o){return(s,t)=>{const n=W;return C(),L("div",ge,[l(n,{color:"#fff",class:"locale"}),Z("div",fe,[l(de),l(me)])])}}});const he=F(xe,[["__scopeId","data-v-8a8cd663"]]);export{he as default};
